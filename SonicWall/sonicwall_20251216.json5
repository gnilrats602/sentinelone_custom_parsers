{
   attributes: {
        "dataSource.category": "security",
        "dataSource.name": "Sonicwall",
        "dataSource.vendor": "Dell",
        // OCSF-ish defaults (can be overridden by KV fields below if present)
		"class_uid": 4001,         // Network Activity (most SonicWall traffic logs)
		"category_uid": 4,         // Network
    },
  timezone: "GMT-0500",
  patterns: {
    // Date/time primitives
	"dateString": "[0-9]{4}-[0-9]{2}-[0-9]{2}",
	"timeString": "[0-9]{2}:[0-9]{2}:[0-9]{2}",
    // Combined timestamp (common SonicWall time="YYYY-MM-DD HH:MM:SS")
    "timestamp": "$dateString$ $timeString$",
    // Networking primitives
	"ipv4": "[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}",
    "port": "[0-9]{1,5}",
	"interface": "[A-Za-z0-9]+",                     // e.g., X0, X1, etc.
    // Composites
    "ipOnly": "$ipv4$",
    "ipPort": "$ipv4$:$port$",
    "ipPortIntf": "$ipv4$:$port$:$interface$"
  },
  formats: [
    {
      "format": "<$syslog_priority$>",
	  "repeat": false
    },
    {
      "format": ".*time=\"$timestamp$\".*",
	  "repeat": false,
	  mappings: {
        "timestamp": "event.time"  // Direct map to OCSF time (will be adjusted by timezone)
      }
    },
    {
      format: ".*appName='$appName$' .*",
      repeat: false,
      mappings: {
        "appName": "application.name"  // temporary capture for appname
      }
    },
    {
      format: ".*\\bdst=$dst_ipv4$:$dst_port$:$dst_interface$\\b .*",
      repeat: false,
      mappings: {
        "dst_ipv4": "connection_info.dst_ip",
        "dst_port": "connection_info.dst_port",
        "dst_interface": "connection_info.dst_interface"
      }
    },
    {
      format: ".*\\bnatDst=$nat_dst_ipv4$:$nat_dst_port$\\b .*",
      repeat: false,
      mappings: {
        "nat_dst_ipv4": "connection_info.nat_dst_ip",
        "nat_dst_port": "connection_info.nat_dst_port"
      }
    },
    {
      format: ".*\\bnatSrc=$nat_src_ipv4$:$nat_src_port$\\b .*",
      repeat: false,
      mappings: {
        "nat_src_ipv4": "connection_info.nat_src_ip",
        "nat_src_port": "connection_info.nat_src_port"
      }
    },
    {
      format: ".*msg=$_=quoteOrSpace$.*",
      repeat: false,
      mappings: {
        "msg": "event.type"
      }
    },

    {
      format: ".*$_=identifier$=$_=quoteOrSpace$.*",
      repeat: true,
	  mappings: {
		// Specific OCSF mappings (case-sensitive to SonicWall keys)
        "src": "connection_info.src_ip",       // Or handle src=ip:port below if needed
        "dst": "connection_info.dst_ip",
        "srcport": "connection_info.src_port",
        "dstport": "connection_info.dst_port",
        "proto": "connection_info.protocol_name",  // e.g., tcp, udp
        "sent": "connection_info.bytes_sent",
        "rcvd": "connection_info.bytes_received",
        "msg": "message",                      // Human-readable event description
        "m": "activity_id",                    // Event code; map to OCSF enums (e.g., 1=Allow, 2=Drop)
        "c": "category_uid",                   // SonicWall category code
        "rule": "firewall_rule.name",
        "srcZone": "src_zone.name",
        "dstZone": "dst_zone.name",
        "usr": "user.name",
        "app": "application.name"
      },
    },
  ]
}
